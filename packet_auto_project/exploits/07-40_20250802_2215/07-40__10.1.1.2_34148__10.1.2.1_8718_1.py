from pwn import *
context.log_level = 'debug'

SIP = "10.1.1.2"
SPORT = 34148

p = remote(SIP, SPORT)

p.send(bytes.fromhex("0a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a2020202020536563757265204d656d6f0a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a20312e2052656164204d656d6f0a20322e205772697465204d656d6f0a20332e20457869740a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a3e3e20"))

data = p.recvn(2)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("456e74657220796f7572206e6577206d656d6f20286d617820323536206279746573293a0a"))

data = p.recvn(18)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("4d656d6f2075706461746564210a0a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a2020202020536563757265204d656d6f0a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a20312e2052656164204d656d6f0a20322e205772697465204d656d6f0a20332e20457869740a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a3e3e20"))

data = p.recvn(2)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("4d656d6f20636f6e74656e743a200a0a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a2020202020536563757265204d656d6f0a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a20312e2052656164204d656d6f0a20322e205772697465204d656d6f0a20332e20457869740a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a"))

data = p.recvn(2)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("3e3e20456e74657220796f7572206e6577206d656d6f20286d617820323536206279746573293a0a"))

data = p.recvn(113)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("4d656d6f2075706461746564210a0a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a2020202020536563757265204d656d6f0a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a20312e2052656164204d656d6f0a20322e205772697465204d656d6f0a20332e20457869740a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a3e3e20"))

data = p.recvn(2)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("427965210a"))

data = p.recvn(1)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.interactive()
