from pwn import *
context.log_level = 'debug'

SIP = "172.30.0.1"
SPORT = 59360

p = remote(SIP, SPORT)

p.send(bytes.fromhex("3d3d3d2044756e67656f6e204d61657374726f2076312e302028737461626c6529203d3d3d0a203120726f6f6d5f637265617465202020203220726f6f6d5f6c696e6b2020202020203320726f6f6d5f73686f770a203420706c617965725f637265617465202035206d6f625f737061776e20202020202036206d6f76650a2037206974656d5f64726f7020202020202038206974656d5f7069636b20202020202039206974656d5f7573650a3130206974656d5f64697363617264202031312071756573745f616464202020202031322071756573745f6163636570740a31332076656e646f725f6372656174652031342076656e646f725f6c69737420202031352076656e646f725f6275790a31362061747461636b20202020202020203137207363726970745f6578656320202031382073657269616c697a650a313920696d706f72745f626c6f622020203230207469636b5f6173796e6320202020323120737461636b5f6c65616b0a323220736176655f73636f7265202020203020657869740a"))

data = p.recvn(3)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("706174683a20"))

data = p.recvn(64)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("5354454c4c417b674141414141426f6a686930753237462d635f4c53594c6842493659783937314a6258315a4b32717a465744726e483252676a777a4545576f6e5753485149425959374d5334376d4d696d71416e302d76784555383056584f494d512d4c455568413d3d7d203120726f6f6d5f637265617465202020203220726f6f6d5f6c696e6b2020202020203320726f6f6d5f73686f770a203420706c617965725f637265617465202035206d6f625f737061776e20202020202036206d6f76650a2037206974656d5f64726f7020202020202038206974656d5f7069636b20202020202039206974656d5f7573650a3130206974656d5f64697363617264202031312071756573745f616464202020202031322071756573745f6163636570740a31332076656e646f725f6372656174652031342076656e646f725f6c69737420202031352076656e646f725f6275790a31362061747461636b20202020202020203137207363726970745f6578656320202031382073657269616c697a650a313920696d706f72745f626c6f622020203230207469636b5f6173796e6320202020323120737461636b5f6c65616b0a323220736176655f73636f7265202020203020657869740a"))

p.interactive()
