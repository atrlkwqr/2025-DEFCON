from pwn import *
context.log_level = 'debug'

SIP = "10.1.2.2"
SPORT = 46646

p = remote(SIP, SPORT)

p.send(bytes.fromhex("0a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a20202020202020686172645f6e6f74650a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a20312e206e65770a20322e20656469740a20332e2073686f770a20342e2064656c6574650a20352e206475706c696361746520287368616c6c6f7720636f707929200a20362e20726573697a6520287265616c6c6f63206d6973757365290a20372e207365745f7072696e7465720a20382e20657869740a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a3e3e20"))

data = p.recvn(2)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("73697a653a20"))

data = p.recvn(4)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("636f6e74656e743a20"))

p.interactive()
