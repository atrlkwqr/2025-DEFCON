from pwn import *
context.log_level = 'debug'

SIP = "172.30.0.1"
SPORT = 37508

p = remote(SIP, SPORT)

p.send(bytes.fromhex("312e204372656174652061206e6f74650a322e20526561642061206e6f74650a332e2057726974652061206e6f74650a342e2044656c6574652061206e6f74650a352e20436865636b2061206e6f74650a302e20457869740a636d64203e20"))

data = p.recvn(5)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("456e7465722073797374656d20636f6d6d616e643a20"))

data = p.recvn(15)
log.info(f"[RECV {len(data)} bytes] {data!r}")

p.send(bytes.fromhex("5354454c4c417b674141414141426f6a617534626d53474950445f4a616f747362426634574170734b786b4f483444457a4e514c6d5768656b446a4f3666445f4c71677a30325966494f6f516e643643485f6e647276506f366a37487239786f5a2d6a7070743159413d3d7d312e204372656174652061206e6f74650a322e20526561642061206e6f74650a332e2057726974652061206e6f74650a342e2044656c6574652061206e6f74650a352e20436865636b2061206e6f74650a302e20457869740a636d64203e20456e7465722073797374656d20636f6d6d616e643a205354454c4c417b674141414141426f6a617534626d53474950445f4a616f747362426634574170734b786b4f483444457a4e514c6d5768656b446a4f3666445f4c71677a30325966494f6f516e643643485f6e647276506f366a37487239786f5a2d6a7070743159413d3d7d"))

p.interactive()
